<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.team1.project.dao.ReviewDAO">
	<select id="getReviewList" resultType="com.team1.project.dto.ReviewDTO">
		SELECT
		    R.REVIEW_NUM,
		    D.DOE_NAME,
		    R.DOE_NUM,
		    R.MEMBER_ID,
		    R.SCORE,
		    R.CONTENT,
		    R.REGDATE,
		    R.DELETEYN
		FROM
		    REVIEW R
		JOIN
		    DOE D ON R.DOE_NUM = D.DOE_NUM
		WHERE
		    R.DOE_NUM = #{doe_num}
		ORDER BY
		    R.REGDATE DESC
</select>


 <!-- 도 평균내기  -->
<select id="averageDoe" resultType="double">
	select avg(score) from review
	where doe_num=#{doe_num}
</select>

<!-- 
<insert id="reviewWrite">
		INSERT INTO DL_REVIEW (
		    ORDER_NUM
		    ,STORE_ID
		    ,REVIEW_CONTENT
		    ,USER_ID
		    ,SCORE
		    ,REVIEW_IMG 
		) VALUES (
			${orderNum }
			,#{storeId }
			,#{reviewContent }
			,#{userId}
			,#{score}
			,#{reviewImg }
		)		
	</insert>
	
	<update id="reviewModify">
    UPDATE DL_REVIEW SET
        REVIEW_CONTENT = #{reviewContent }
        ,SCORE = #{score}
        
        <if test="reviewImg != null">
        ,REVIEW_IMG = #{reviewImg }
        </if>
        
    WHERE
        ORDER_NUM = ${orderNum }    
	</update> -->

</mapper>